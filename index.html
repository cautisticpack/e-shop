<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mi Tienda</title>
<style>
:root{
  --bg:#000;
  --header-height:48px;
  --header-expanded:88px;
  --text-color:#fff;
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial;background:var(--bg);color:var(--text-color)}

/* FONDO ARRIBA CON PRODUCTOS */
.fondo-top {
  width: 100%;
  height: 650px; /* altura vertical más grande */
  background: url("cautisticpack.jpg") no-repeat center 45%;
  background-size: cover;
  position: relative;
  display: flex;
  justify-content: center; /* centra horizontalmente */
  align-items: flex-end;   /* coloca los productos abajo de la franja */
  padding-bottom: 20px;    /* separación desde el fondo */
  z-index: 0;
  overflow: hidden;        /* limita las espadas dentro de la franja */
}

/* SECCION PRODUCTOS */
.seccion {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px,1fr));
  gap: 20px;
  max-width: 1250px;
  width: 98%;
  position: relative;
  z-index: 1; /* encima del fondo, debajo del header */
}

/* HEADER */
.header-wrap{position:fixed;left:50%;transform:translateX(-50%);top:20px;z-index:1000;width:90%;max-width:1100px;pointer-events:none;transition:top .3s ease}
header.header{pointer-events:auto;height:var(--header-height);border-radius:12px;display:flex;align-items:center;justify-content:space-between;padding:0 18px;overflow:hidden;position:relative;box-shadow:0 6px 20px rgba(0,0,0,.45);transition:height .3s cubic-bezier(.2,.9,.3,1),box-shadow .3s,padding .3s}
header.header .header-img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;z-index:-1}
header.header.expanded{height:var(--header-expanded);padding:12px 22px;box-shadow:0 12px 30px rgba(0,0,0,.55)}

.brand {
  font-weight: 800;
  letter-spacing: .3px;
  font-size: 26px;
  color: var(--text-color);
  -webkit-text-stroke: 1px black;
  text-shadow: 0 2px 4px rgba(0,0,0,.7);
  -webkit-font-smoothing: antialiased;
  font-smooth: always;
}

nav.nav{display:flex;gap:18px;align-items:center;opacity:0;transform:translateY(-6px);transition:opacity .22s ease,transform .22s ease}
header.header.expanded nav.nav, header.header:hover nav.nav{opacity:1;transform:translateY(0)}
nav.nav a {
  text-decoration: none;
  color: var(--text-color);
  font-weight: 700;
  font-size: 22px;
  -webkit-text-stroke: 0.8px black;
  text-shadow: 0 1.5px 3px rgba(0,0,0,.7);
  transition: transform .2s;
  margin-left: -10px;
}
nav.nav a:hover{ transform: scale(1.05); }

/* CASILLAS PRODUCTOS */
.casilla{background-color:rgba(255,255,255,0.9);border-radius:12px;display:flex;justify-content:center;align-items:center;padding:20px;min-height:260px;transition:transform .3s ease,box-shadow .3s ease}
.casilla:hover{transform:scale(1.05);box-shadow:0 8px 20px rgba(0,0,0,.4)}
.producto-img{max-width:100%;max-height:100%;object-fit:contain}

/* FONDO DE ESPADAS DENTRO DE LA FRANJA */
.fondo-espadas{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;overflow:hidden;z-index:0}
.espada{position:absolute;width:38px;transform-origin:center;will-change:transform,left,top;opacity:0.95}

/* IMAGEN CHICA LADO IZQUIERDO */
#chicaHeader {
  position: fixed;
  top: 0;
  left: 0;
  height: 130px;
  z-index: 500;
  pointer-events: none;
}

/* PAGE */
.page{min-height:200vh;position:relative;}

/* Responsive */
@media (max-width:500px){
  .seccion{grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:15px}
  .casilla{min-height:200px;padding:10px}
  .espada{width:28px}
  #chicaHeader{height:70px;}
}

@media (max-width:350px){
  #chicaHeader{height:50px;}
}
</style>
</head>
<body>

<!-- FRANJA SUPERIOR CON PRODUCTOS -->
<div class="fondo-top">
  <div class="fondo-espadas" id="fondoEspadas"></div>
  <section class="seccion">
    <a class="casilla" href="https://amzn.to/3IHXFsY" target="_blank" rel="noopener noreferrer">
      <img src="Imagenes/tazasretro.PNG" alt="Taza retro" class="producto-img" loading="lazy">
    </a>
    <a class="casilla" href="https://amzn.to/4nS7dAy" target="_blank" rel="noopener noreferrer">
      <img src="Imagenes/bo2mando.PNG" alt="Mando BO2" class="producto-img" loading="lazy">
    </a>
    <a class="casilla" href="https://amzn.to/3VXQsYZ" target="_blank" rel="noopener noreferrer">
      <img src="Imagenes/iphone17case.PNG" alt="Funda iPhone 17" class="producto-img" loading="lazy">
    </a>
  </section>
</div>

<!-- AUDIO -->
<audio id="backgroundMusic" loop>
  <source src="Musica/crystal.mp3" type="audio/mpeg">
</audio>

<!-- IMAGEN CHICA -->
<img src="Imagenes/chica1.PNG" alt="Chica" id="chicaHeader">

<!-- HEADER -->
<div class="header-wrap" id="headerWrap">
  <header class="header" id="siteHeader" aria-label="Encabezado principal">
    <img src="cautisticpack1.jpg" alt="Caballeros" class="header-img">
    <div class="brand">Mi Tienda</div>
    <nav class="nav">
      <a href="foro.html">Foro</a>
    </nav>
  </header>
</div>

<main class="page">
  <!-- Aquí puedes agregar más secciones -->
</main>

<script>
/* HEADER */
const headerWrap=document.getElementById('headerWrap');
const header=document.getElementById('siteHeader');
let lastScroll=0;
window.addEventListener('scroll',()=>{
  const currentScroll=window.scrollY;
  headerWrap.style.top=(currentScroll>lastScroll && currentScroll>100)?'-100px':'0';
  lastScroll=currentScroll;
  if(window.scrollY===0){header.classList.add('expanded'); headerWrap.style.top='20px';}
  else header.classList.remove('expanded');
});
header.addEventListener('mouseenter',()=>header.classList.add('expanded'));
header.addEventListener('mouseleave',()=>{if(window.scrollY!==0)header.classList.remove('expanded');});
window.addEventListener('load',()=>{if(window.scrollY===0)header.classList.add('expanded');});

/* ESPADAS LIMITADAS A LA FRANJA */
const fondo=document.getElementById('fondoEspadas');
const NUM_ESPADAS=9;
const espadas=[];
const minVerticalGapPx=fondo.offsetHeight*0.08;
function generarTopConSeparacion(existingYs,attempts=50){
  const minPct=6,maxPct=92;
  for(let i=0;i<attempts;i++){
    const pct=Math.random()*(maxPct-minPct)+minPct;
    const yPx=pct/100*fondo.offsetHeight;
    let ok=true;
    for(const other of existingYs){if(Math.abs(other-yPx)<minVerticalGapPx){ok=false;break;}}
    if(ok) return yPx;
  }
  return (Math.random()*(maxPct-minPct)+minPct)/100*fondo.offsetHeight;
}
const existingYs=[];
for(let i=0;i<NUM_ESPADAS;i++){
  const e=document.createElement('img');
  e.src='Imagenes/espada1.png';
  e.className='espada';
  const sizePx=Math.round((Math.random()*12)+32);
  e.style.width=sizePx+'px';
  const leftPct=Math.random()*88+6;
  e.style.left=leftPct+'%';
  const yPx=generarTopConSeparacion(existingYs);
  existingYs.push(yPx);
  e.style.top=(yPx/fondo.offsetHeight*100)+'%';
  e.dataset.x=leftPct/100*fondo.offsetWidth;
  e.dataset.y=yPx;
  e.dataset.vx=(Math.random()*0.24+0.06)*(Math.random()<0.5?-1:1);
  e.dataset.vy=(Math.random()*0.14+0.03)*(Math.random()<0.5?-1:1);
  e.dataset.angle=Math.random()*360;
  e.dataset.vr=Math.random()*0.6-0.3;
  fondo.appendChild(e);
  espadas.push(e);
}
function animarEspadas(){
  const w=fondo.offsetWidth,h=fondo.offsetHeight;
  for(const e of espadas){
    let x=parseFloat(e.dataset.x),y=parseFloat(e.dataset.y);
    x+=parseFloat(e.dataset.vx);y+=parseFloat(e.dataset.vy);
    const ew=e.offsetWidth,eh=e.offsetHeight;
    if(x<-ew)x=w;if(x>w)x=-ew;if(y<-eh)y=h;if(y>h)y=-eh;
    let angle=parseFloat(e.dataset.angle)+parseFloat(e.dataset.vr);
    e.dataset.angle=angle;
    e.style.left=(x/w*100)+'%';
    e.style.top=(y/h*100)+'%';
    e.style.transform=`rotate(${angle}deg)`;
    e.dataset.x=x; e.dataset.y=y;
  }
  requestAnimationFrame(animarEspadas);
}
animarEspadas();

/* AUDIO FADE-IN */
const music = document.getElementById('backgroundMusic');
music.volume = 0;
let fadeInDone = false;
const playMusic = () => {
  if (!fadeInDone) {
    music.play().then(() => {
      let vol = 0;
      const target = 0.45;
      const fadeIn = setInterval(() => {
        if (vol < target) {
          vol = Math.min(target, vol + 0.01);
          music.volume = vol;
        } else {
          clearInterval(fadeIn);
          fadeInDone = true;
        }
      }, 50);
    }).catch(()=>{console.log("Autoplay bloqueado, se necesita interacción.");});
  } else {
    if (music.paused) music.play().catch(()=>{});
  }
};
window.addEventListener('load', playMusic);
window.addEventListener('click', playMusic, { once: true });
window.addEventListener('keydown', playMusic, { once: true });
window.addEventListener('touchstart', playMusic, { once: true });
window.addEventListener('wheel', playMusic, { once: true });
window.addEventListener('scroll', playMusic, { once: true });
</script>
</body>
</html>
